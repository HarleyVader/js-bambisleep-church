<%- include('../partials/header') %>

<main>
    <div class="container">
        <section class="ai-crawl-section">
            <h1>AI Crawl Control</h1>
            <p>Manage AI-powered content discovery and crawling.</p>
            
            <div class="ai-crawl-controls">
                <% if (typeof canStart !== 'undefined' && canStart) { %>
                    <form method="POST" action="/api/ai-crawl/start" class="crawl-form">
                        <div class="form-group">
                            <label for="query">Search Query</label>
                            <input type="text" id="query" name="query" placeholder="Enter search terms..." required>
                        </div>
                        
                        <div class="form-group">
                            <label for="maxResults">Max Results</label>
                            <input type="number" id="maxResults" name="maxResults" value="10" min="1" max="100">
                        </div>
                        
                        <button type="submit" class="start-crawl-btn">Start AI Crawl</button>
                    </form>
                <% } else { %>
                    <div class="crawl-disabled">
                        <p>AI crawl is currently unavailable or already running.</p>
                    </div>
                <% } %>
            </div>
            
            <div class="ai-crawl-status">
                <h2>Current Status</h2>
                <% if (typeof status !== 'undefined' && status) { %>
                    <div class="status-info">
                        <p>Status: <%= status.isRunning ? 'Running' : 'Idle' %></p>
                        <% if (status.currentQuery) { %>
                            <p>Current Query: <%= status.currentQuery %></p>
                        <% } %>
                        <% if (status.progress) { %>
                            <p>Progress: <%= status.progress %>%</p>
                        <% } %>
                    </div>
                <% } else { %>
                    <p>No status information available.</p>
                <% } %>
            </div>
            
            <div class="recent-results">
                <h2>Recent Discoveries</h2>
                <% if (typeof recentResults !== 'undefined' && recentResults && recentResults.length > 0) { %>
                    <div class="results-list">
                        <% recentResults.forEach(result => { %>
                            <div class="result-item">
                                <h4><%= result.title || 'Untitled' %></h4>
                                <% if (result.url) { %>
                                    <a href="<%= result.url %>" target="_blank">View</a>
                                <% } %>
                                <% if (result.description) { %>
                                    <p><%= result.description %></p>
                                <% } %>
                            </div>
                        <% }) %>
                    </div>
                <% } else { %>
                    <p>No recent discoveries available.</p>
                <% } %>
            </div>
        </section>
    </div>
</main>

<%- include('../partials/footer') %>
