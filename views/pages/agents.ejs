<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Agents - Bambi Sleep Church</title>
  <link rel="stylesheet" href="/css/style.css">
  <!-- moved styles to style.css -->
</head>
<body>
  <%- include('../partials/header') %>
  <div class="agents-container">
    <h1 class="agent-title agent-title-center">AI Agents</h1>
    <form action="/agents/submit-url" method="POST" class="agent-url-form">
      <input type="url" name="url" placeholder="Enter URL" required class="agent-url-input">
      <button type="submit" class="agent-url-btn">Submit URL</button>
    </form>
    <% if (agentTasks && agentTasks.length) { %>
      <% agentTasks.forEach(function(task) { %>
        <div class="agent-task">
          <div class="agent-title"><%= task.title %></div>
          <div class="agent-desc"><%= task.description %></div>
          <div class="progress-bar-bg">
            <div class="progress-bar" style="width:<%= task.completion %>%;"></div>
          </div>
          <div class="agent-status">
            <%= task.status %> &mdash; <%= task.completion %>% complete
          </div>
          <% if (task.stats) { %>
            <div class="agent-stats">
              <div><b>Crawled URL:</b> <%= task.stats.crawledUrl || '-' %></div>
              <div><b>URLs Found:</b> <%= task.stats.urlsFound || (task.foundUrls ? task.foundUrls.length : 0) %></div>
              <% if (task.stats.other) { %>
                <div><%= task.stats.other %></div>
              <% } %>
            </div>
          <% } %>
          <% if (task.foundUrls && task.foundUrls.length) { %>
            <div class="agent-found-urls">
              <div class="agent-found-urls-title"><b>Found URLs:</b></div>
              <ul class="agent-found-urls-list">
                <% task.foundUrls.forEach(function(url) { %>
                  <li>
                    <a href="<%= url %>" target="_blank"> <%= url %> </a>
                  </li>
                <% }) %>
              </ul>
            </div>
          <% } %>
        </div>
      <% }) %>
    <% } else { %>
      <div style="text-align:center; color:#aaa;">No agent tasks running.</div>
    <% } %>
  </div>
  <%- include('../partials/footer') %>
</body>
</html>
